/*
 @preserve
 jquery.scrolldepth.js | v1.0
  - Original version found here: https://github.com/robflaherty/jquery-scrolldepth
  - Modifications made in this setup, search code for "modified" to find all locations where changes were made
 Copyright (c) 2016 Rob Flaherty (@robflaherty)
 Licensed under the MIT and GPL licenses.
*/
Bootstrapper.bindDependencyImmediate(function(){var Bootstrapper=window["Bootstrapper"];var ensightenOptions=Bootstrapper.ensightenOptions;if(Bootstrapper&&Bootstrapper.hasOwnProperty("ensightenOptions")&&Bootstrapper.ensightenOptions.hasOwnProperty("publishPath")&&Bootstrapper.ensightenOptions.publishPath.indexOf("dev")>-1)Bootstrapper._doConsole=true;window.initializeScrollDepth=function(){Bootstrapper._doConsole?console.log("window.initializeScrollDepth called"):null;jQuery.scrollDepth({elements:[".main div.content \x3e div:not(.mayoad) \x3e h2"]})};
function checkScrollDepthReady(){if(window.jQuery&&typeof window.jQuery==="function"&&window.jQuery.scrollDepth&&typeof window.jQuery.scrollDepth==="function"){Bootstrapper._doConsole?console.log("readiness checks passed, calling window.initializeScrollDepth"):null;window.initializeScrollDepth()}else setTimeout(checkScrollDepthReady,50)}checkScrollDepthReady()},3218516,[3812049,3218515],639726,[265954,639723]);
Bootstrapper.bindDependencyImmediate(function(){var Bootstrapper=window["Bootstrapper"];var ensightenOptions=Bootstrapper.ensightenOptions;if(Bootstrapper&&Bootstrapper.hasOwnProperty("ensightenOptions")&&Bootstrapper.ensightenOptions.hasOwnProperty("publishPath")&&Bootstrapper.ensightenOptions.publishPath.indexOf("dev")>-1)Bootstrapper._doConsole=true;function addScrollDepthPlugin(){Bootstrapper._doConsole?console.log("addScrollDepthPlugin called"):null;(function(factory){Bootstrapper._doConsole?
console.log("Universal module definition",factory):null;factory(jQuery);Bootstrapper._doConsole?console.log("Universal module definition - browser globals",jQuery,factory):null})(function($){var defaults={minHeight:0,elements:[],percentage:false,frequency:10,userTiming:false,pixelDepth:false,nonInteraction:true,gaGlobal:false,gtmOverride:false,trackerName:false,dataLayer:"dataLayer",bslnPctAct:"percentage",bslnElmAct:"elements",bslnLbl:"baseline",elmCat:"scroll depth",elmAct:'"\x3c" + this.tagName.toLowerCase() + "\x3e"',
elmLbl:"jQuery(this).text().trim().toLowerCase()",pctCat:"scroll depth",pctAct:"percentage",pxlAct:"pixel depth",container:$(window)};var $container=$(window),cache=[],scrollEventBound=false,maxScrollEvents=0,lastPixelDepth=0,universalGA,classicGA,gaGlobal,globalSiteTag,standardEventHandler;$.scrollDepth=function(options){var startTime=+new Date;options=$.extend({},defaults,options);if($container!=options.container){Bootstrapper._doConsole?console.log("$container being updated to match customized from options - original: ",
$container,"updated: ",options.container):null;$container=options.container}if($(document).height()<options.minHeight)return;if(options.gaGlobal){universalGA=true;gaGlobal=options.gaGlobal}else if(typeof gtag==="function"){globalSiteTag=true;gaGlobal="gtag"}else if(typeof ga==="function"){universalGA=true;gaGlobal="ga"}else if(typeof __gaTracker==="function"){universalGA=true;gaGlobal="__gaTracker"}if(typeof _gaq!=="undefined"&&typeof _gaq.push==="function")classicGA=true;if(typeof options.eventHandler===
"function")standardEventHandler=options.eventHandler;else if(typeof window[options.dataLayer]!=="undefined"&&typeof window[options.dataLayer].push==="function"&&!options.gtmOverride)standardEventHandler=function(data){window[options.dataLayer].push(data)};Bootstrapper._doConsole?console.log("standardEventHandler logic checks",options.eventHandler,options.dataLayer):null;Bootstrapper._doConsole?console.log("standardEventHandler",standardEventHandler):null;Bootstrapper._doConsole?console.log("globalSiteTag",
globalSiteTag):null;Bootstrapper._doConsole?console.log("gaGlobal",gaGlobal):null;Bootstrapper._doConsole?console.log("options",options):null;if(!(gaGlobal||classicGA||standardEventHandler)){Bootstrapper._doConsole?console.log("reinitializing scroll tracking due to missing analytics tracking",options):null;setTimeout(function(){window.initializeScrollDepth(options)},50);return}function sendBaseline(category,action){Bootstrapper._doConsole?console.log("sendBaseline called",category,action):null;var command=
options.trackerName?options.trackerName+".send":"send";if(standardEventHandler){standardEventHandler({event:"ScrollDistance",eventCategory:options.pctCat,eventAction:action,eventLabel:options.bslnLbl,eventValue:1,eventNonInteraction:!0});if(globalSiteTag){Bootstrapper._doConsole?console.log("calling window.gtag",category,action,options.bslnLbl,options.nonInteraction):null;window.gtag("event",action,{"event_category":category,"event_label":options.bslnLbl,"non_interaction":options.nonInteraction})}}else{if(universalGA)if(Bootstrapper.hasOwnProperty("_GAMT")&&
Bootstrapper._GAMT.hasOwnProperty("__TrackIt")&&typeof Bootstrapper._GAMT.__TrackIt=="function"){Bootstrapper._doConsole?console.log("calling Bootstrapper._GAMT.__TrackIt",category,action,options.bslnLbl,options.nonInteraction):null;Bootstrapper._GAMT.__TrackIt([command,"event",category,action,options.bslnLbl,1,{"nonInteraction":options.nonInteraction}])}else{Bootstrapper._doConsole?console.log("calling window["+gaGlobal+"]",category,action,options.bslnLbl,options.nonInteraction):null;window[gaGlobal](command,
"event",category,action,options.bslnLbl,1,{"nonInteraction":options.nonInteraction})}if(classicGA){Bootstrapper._doConsole?console.log("calling _gaq.push",category,action,options.bslnLbl,options.nonInteraction):null;_gaq.push(["_trackEvent",category,action,options.bslnLbl,1,options.nonInteraction])}}}function sendEvent(category,action,label,scrollDistance,timing){Bootstrapper._doConsole?console.log("sendEvent called",category,action,label,scrollDistance,timing):null;var command=options.trackerName?
options.trackerName+".send":"send";if(standardEventHandler){standardEventHandler({"event":"ScrollDistance","eventCategory":category,"eventAction":action,"eventLabel":label,"eventValue":1,"eventNonInteraction":options.nonInteraction});if(options.pixelDepth&&arguments.length>2&&scrollDistance>lastPixelDepth){lastPixelDepth=scrollDistance;standardEventHandler({"event":"ScrollDistance","eventCategory":category,"eventAction":options.pxlAct,"eventLabel":rounded(scrollDistance),"eventValue":1,"eventNonInteraction":options.nonInteraction})}if(options.userTiming&&
arguments.length>3)standardEventHandler({"event":"ScrollTiming","eventCategory":category,"eventAction":action,"eventLabel":label,"eventTiming":timing});if(globalSiteTag){Bootstrapper._doConsole?console.log("calling window.gtag",category,action,label,timing,options.nonInteraction):null;window.gtag("event",action,{"event_category":category,"event_label":label,"non_interaction":options.nonInteraction});if(options.userTiming&&arguments.length>3)window.gtag("event","timing_complete",{"name":action,"value":timing,
"event_category":category,"event_label":label})}}else{if(universalGA)if(Bootstrapper.hasOwnProperty("_GAMT")&&Bootstrapper._GAMT.hasOwnProperty("__TrackIt")&&typeof Bootstrapper._GAMT.__TrackIt=="function"){Bootstrapper._doConsole?console.log("calling Bootstrapper._GAMT.__TrackIt",category,action,label,timing,options.nonInteraction):null;Bootstrapper._GAMT.__TrackIt([command,"event",category,action,label,1,{"nonInteraction":options.nonInteraction}]);if(options.pixelDepth&&arguments.length>2&&scrollDistance>
lastPixelDepth){lastPixelDepth=scrollDistance;Bootstrapper._GAMT.__TrackIt([command,"event",category,options.pxlAct,rounded(scrollDistance),1,{"nonInteraction":options.nonInteraction}])}if(options.userTiming&&arguments.length>3)Bootstrapper._GAMT.__TrackIt([command,"timing",category,action,timing,label])}else{Bootstrapper._doConsole?console.log("calling window["+gaGlobal+"]",category,action,label,timing,options.nonInteraction):null;window[gaGlobal](command,"event",category,action,label,1,{"nonInteraction":options.nonInteraction});
if(options.pixelDepth&&arguments.length>2&&scrollDistance>lastPixelDepth){lastPixelDepth=scrollDistance;window[gaGlobal](command,"event",category,options.pxlAct,rounded(scrollDistance),1,{"nonInteraction":options.nonInteraction})}if(options.userTiming&&arguments.length>3)window[gaGlobal](command,"timing",category,action,timing,label)}if(classicGA){Bootstrapper._doConsole?console.log("calling _gaq.push",category,action,label,timing,options.nonInteraction):null;_gaq.push(["_trackEvent",category,action,
label,1,options.nonInteraction]);if(options.pixelDepth&&arguments.length>2&&scrollDistance>lastPixelDepth){lastPixelDepth=scrollDistance;_gaq.push(["_trackEvent",category,options.pxlAct,rounded(scrollDistance),1,options.nonInteraction])}if(options.userTiming&&arguments.length>3)_gaq.push(["_trackTiming",category,action,timing,label,100])}}}function calculateMarks(docHeight,mlstnCnt){var milestoneObj={},i;for(i=1;i<=mlstnCnt;i++){var milestoneVal=options.frequency*i;if(i==mlstnCnt)milestoneObj["100%"]=
docHeight-5;else milestoneObj[milestoneVal+"%"]=parseInt(docHeight*(milestoneVal/100),10)}return milestoneObj}function checkMarks(marks,scrollDistance,timing){Bootstrapper._doConsole?console.log("checkMarks called",marks,scrollDistance,timing):null;$.each(marks,function(key,val){if($.inArray(key,cache)===-1&&scrollDistance>=val){sendEvent(options.pctCat,options.pctAct,key,scrollDistance,timing);cache.push(key)}})}function checkElements(elements,scrollDistance,timing){Bootstrapper._doConsole?console.log("checkElements called",
elements,scrollDistance,timing):null;$.each(elements,function(index,elem){Bootstrapper._doConsole?console.log("checkElements - $.each",index,elem):null;$(elem+":visible").each(function(){Bootstrapper._doConsole?console.log("checkElements - $(elem).each",this,this.tagName,$(this).text(),cache):null;if($.inArray(this,cache)===-1&&$(this).length)if(scrollDistance>=$(this).offset().top){Bootstrapper._doConsole?console.log("calling sendEvent",options.elmCat,eval(options.elmAct),eval(options.elmLbl),scrollDistance,
timing):null;sendEvent(options.elmCat,eval(options.elmAct),eval(options.elmLbl),scrollDistance,timing);cache.push(this)}})})}function rounded(scrollDistance){Bootstrapper._doConsole?console.log("rounded called",scrollDistance):null;return(Math.floor(scrollDistance/250)*250).toString()}function init(){Bootstrapper._doConsole?console.log("init called"):null;bindScrollDepth()}$.scrollDepth.reset=function(){Bootstrapper._doConsole?console.log("reset called"):null;cache=[];lastPixelDepth=0;$container.off("scroll.scrollDepth");
bindScrollDepth()};$.scrollDepth.addElements=function(elems){Bootstrapper._doConsole?console.log("addElements called",elems):null;if(typeof elems=="undefined"||!$.isArray(elems))return;$.merge(options.elements,elems);if(!scrollEventBound)bindScrollDepth()};$.scrollDepth.removeElements=function(elems){Bootstrapper._doConsole?console.log("removeElements called",elems):null;if(typeof elems=="undefined"||!$.isArray(elems))return;$.each(elems,function(index,elem){var inElementsArray=$.inArray(elem,options.elements);
var inCacheArray=$.inArray(elem,cache);if(inElementsArray!=-1)options.elements.splice(inElementsArray,1);if(inCacheArray!=-1)cache.splice(inCacheArray,1)})};function throttle(func,wait){Bootstrapper._doConsole?console.log("throttle called",func,wait):null;var context,args,result;var timeout=null;var previous=0;var later=function(){previous=new Date;timeout=null;result=func.apply(context,args)};return function(){var now=new Date;if(!previous)previous=now;var remaining=wait-(now-previous);context=this;
args=arguments;if(remaining<=0){clearTimeout(timeout);timeout=null;previous=now;result=func.apply(context,args)}else if(!timeout)timeout=setTimeout(later,remaining);return result}}function bindScrollDepth(){scrollEventBound=true;maxScrollEvents=jQuery(options.elements.toString()).length+(options.percentage?Math.round(100/options.frequency):0);Bootstrapper._doConsole?console.log("maxScrollEvents",cache,cache.length,maxScrollEvents):null;if(options.percentage&&options.elements.length)sendBaseline(options.pctCat,
options.bslnPctAct+" \x26 "+options.bslnElmAct);else options.percentage?sendBaseline(options.pctCat,options.bslnPctAct):options.elements.length&&sendBaseline(options.elmCat,options.bslnElmAct);$container.on("scroll.scrollDepth",throttle(function(){var docHeight=$(document).height(),cntnrHeight=$container[0].innerHeight?$container[0].innerHeight:$container.height(),scrollDistance=$container.scrollTop()+cntnrHeight,marksCnt=Math.round(100/options.frequency),marks=calculateMarks(docHeight,marksCnt),
timing=+new Date-startTime;if(cache.length>=maxScrollEvents){Bootstrapper._doConsole?console.log("turning off scrollDepth tracking",cache.length,maxScrollEvents):null;$container.off("scroll.scrollDepth");scrollEventBound=false;cache=[];return}if(options.elements){Bootstrapper._doConsole?console.log("calling checkElements",options.elements,scrollDistance,timing):null;checkElements(options.elements,scrollDistance,timing)}if(options.percentage){Bootstrapper._doConsole?console.log("calling checkMarks",
marks,scrollDistance,timing):null;checkMarks(marks,scrollDistance,timing)}},500))}init()};return $.scrollDepth})}function checkjQueryReady(){if(window.jQuery&&typeof window.jQuery==="function"){Bootstrapper._doConsole?console.log("readiness checks passed, calling addScrollDepthPlugin"):null;addScrollDepthPlugin()}else setTimeout(checkjQueryReady,50)}checkjQueryReady()},3218515,[3812049],639723,[265954]);